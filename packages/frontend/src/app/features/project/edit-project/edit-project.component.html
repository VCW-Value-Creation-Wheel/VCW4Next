<div class="m-4 p-4">
    <app-button  
    [label]="'Back'"
    [leftIcon]="faArrowLeft"
    (click)="onBack()"
    ></app-button>
</div>
<div [formGroup]="form" (ngSubmit)="onSubmit($event)">
    <div class="grid grid-cols-4 gap-4 m-4 p-4 rounded-lg">
        <div class="col-span-4 text-2xl font-bold text-primary">Edit Project</div>
        <div class="col-span-3 md:col-span-2 m-2 p-2">
            <app-input
                id="project-title"
                [label]="'Project Title'"
                [placeholder]="''"
                formControlName="name"
            >
            </app-input>
        </div>
        <div class="col-span-4 m-2 p-2">
            <app-text-area
                id="project-description"   
                [label]="'Project Description'"
                [placeholder]="''"
                formControlName="description"
            >
            </app-text-area>
        </div>
        <div class="col-span-3 md:col-span-1 m-2 p-2">
            <app-input-file
                [label]="'Thumbnail'"
                id="project-thumbnail"
                ngDefaultControl
             
                (change)="onFileSelected($event)"
            >
            </app-input-file>
        </div>
        <div class="col-span-3 md:col-span-1 m-2 p-2">
            <app-select-input
                [label] = "'Language'"
                [options]="langOptions"
                formControlName="lang"
                id="project-language"
            >
            </app-select-input>
        </div>
        <div class="col-span-4 text-xl font-bold ">Users and Roles</div>
        <div class="grid grid-cols-4 col-span-4 px-2">
            <div *ngFor="let userEntry of userRole; index as ind" class="col-span-3 flex justify-between m-2 p-2 bg-gray-200 rounded-md">
                    <div class="m-2">{{userEntry.user}} - {{userEntry.role}}</div>
                    <div class="">
                        <app-icon-button [icon]="faPenToSquare" (click)="editUser(ind)"></app-icon-button>
                        <app-icon-button [icon]="faXmark" (click)="removeUser(ind)"></app-icon-button>
                    </div>
            </div>
            <div *ngIf="isAddUserActive || isEditing" class="grid grid-cols-4 col-span-4 gap-1"  [formGroupName]="getUserArrayIndex(isEditing)">
                <div class="flex flex-col align-top col-span-2">
                    <label class="{{isDisabled?'text-gray-400':'text-gray-700'}} py-1">
                    Select User
                    </label>
                    <input
                    class="
                        focus:outline-none
                        caret-primary-500
                        block
                        w-full
                        rounded-md
                        border border-transparent
                        max-h-[40px]
                        focus:ring-primary-500 focus:bg-white focus:ring-1
                        py-2
                        px-3
                        {{error?'bg-red-200':'bg-gray-100'}}
                    "
                    list="userList"
                    formControlName="user"
                    />
                </div>
                <datalist id="userList">
                    <option *ngFor="let option of options">{{option}}</option>
                </datalist>
                <div class="col-span-2 md:col-span-1">
                    <app-select-input
                    [label]="'Select Role'"
                    [options]="roleOptions"
                    formControlName="role"
                    >
                    </app-select-input>
                </div>
                <div class="flex justify-end md:justify-start col-span-4 md:col-span-1">
                    <div *ngIf="isAddUserActive" class="mx-1 mt-7">
                        <app-button
                        [label]="'Add'"
                        (click)="confirmUser()"
                        >
                        </app-button>
                    </div>
                    <div *ngIf="isEditing" class="mx-1 mt-7">
                        <app-button
                        [label]="'Edit'"
                        (click)="confirmEditUser()"
                        >
                        </app-button>
                    </div> 
                    <div class="mx-1 mt-7">
                        <app-button
                        [label]="'Cancel'"
                        (click)="cancelUserSelection()"
                        > 
                        </app-button>
                    </div>
                </div>
                 
            </div>
            <div class="col-span-4 my-2" *ngIf="!isAddUserActive && !isEditing">
                <app-button
                [label]="'Add User'"
                (click)="addUser()">
                </app-button>
            </div>
        </div>
        <div class="m-2 flex">
            <app-button
            [label]="'Submit'"
            (click)="onSubmit($event)"
            [isDisabled]="!form.valid"
            >
            </app-button>
        </div>
    </div>
</div>